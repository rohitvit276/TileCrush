# server.conf - Splunk Enterprise Deployment Server Configuration
# Generated by Ansible on {{ ansible_date_time.iso8601 }}

[general]
serverName = {{ splunk_instance_name | default(inventory_hostname) }}
pass4SymmKey = {{ splunk_deployment_server_pass4symmkey }}

[sslConfig]
{% if splunk_ssl_enabled %}
enableSplunkdSSL = true
sslKeysfile = {{ splunk_ssl_key_path }}
sslCertPath = {{ splunk_ssl_cert_path }}
{% else %}
enableSplunkdSSL = false
{% endif %}

[httpServer]
port = {{ splunk_mgmt_port }}

[deploymentServer]
# Enable deployment server functionality
disabled = false
repositoryLocation = {{ splunk_home }}/etc/deployment-apps
serverRepositoryLocationPolicy = rejectAlways
targetRepositoryLocation = $SPLUNK_HOME/etc/apps

# Deployment server performance settings
crossServerChecksum = true
filterType = whitelist

[replication_port://{{ splunk_deployment_server_port }}]
disabled = false

{% if splunk_indexes is defined %}
{% for index in splunk_indexes %}
[volume:{{ index.name }}_volume]
path = {{ splunk_home }}/var/lib/splunk/{{ index.name }}db
maxVolumeDataSizeMB = {{ index.max_data_size | regex_replace('GB', '000') | regex_replace('MB', '') }}

{% endfor %}
{% endif %}

[license]
master_uri = self

[clustering]
mode = searchhead
pass4SymmKey = {{ splunk_deployment_server_pass4symmkey }}
